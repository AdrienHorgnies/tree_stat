dist: xenial
language: python
python:
- '3.5'
- '3.6'
- '3.7'
cache: pip
before_install:
- pip install --upgrade pip # travis use an ancient version...
- pip install pip-tools # pip-tools to generate requirements.txt
- pip-compile # generate requirements.txt
before_script:
  - pip install -e .[dev] # install dev dependencies to test
script:
- python -m pytest # unit tests
- python setup.py build install # build and install so that I can test
- cd tests/assets
- python -m tree_stat sample-tree -o travis-stat.md # test script against sample data
- diff travis-stat.md sample-tree-stat.md # compare sample result with expected result
- cd ../..
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  user: ahorgnies
  server: https://test.pypi.org/legacy/
  on:
    tags: true
  password:
    secure: nfsCd05PmmJYeQe4+q+PJ27HRLnfY8PWnbrOkWv7M/fPcSHGpRE88SvQY6fixZj9Dm32TMAFM2uHeWsrgnXXt7dF5QJTRQHsGJ/KAeHL3v2KhXJEmPI4a5yE8rGXKKXRTOLafMfH8BqFdQkdQ0SQ8PxRr7YhNXQxcdsbiA84PiW19RWs92JxoF042i9+TeN5fagHwteMtliVfaorFSPnnWW4LASljuef80b59mwnNdBAn8rwH1H1b/wVuWD6iHo0Cfx36P8uaufKebF0iTSYCURqVVc7KJ+rctj03ZnpOAtKL1q+imrPIACsP7slvfT4HrT5ad1slbnM+Gaste6QQ5Hq4jxvMI3Ri24RXysIsBBjYRDBgblu6yjtjSipid9dQvfcQ9lLPrOH+5/8HHH1tOp+KFgn2umFqJOB3Jtd9J/7MVGRov4cMzBeiZEWu/jr4ioQZLAJzQwZdhMi8Qho/iHJMzL8tgM1uLnZtqWoiKB7BRGP6adZU+UJ30xw1AlB8EZwtKw7eJ5Dj8Q5DdGgfHWS+W8IsulQoDhwoJeLwPcE63IYlJNQFYQrJYoR8SRhoUw+xnvxmTqaS+fYe8ZUYAhAH0+KeFHo9L+0FnKF6d1BC90nJlpW5nGPmAS4pZnfzVXUNCuun6XVwT5TOmluE+/9ppba2C0ftaCdE4d2djE=
