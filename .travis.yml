dist: xenial
language: python
python:
- '3.5'
- '3.6'
- '3.7'
cache: pip
before_install:
- pip install --upgrade pip # travis use an ancient version...
- pip install pip-tools # pip-tools to generate requirements.txt
- pip-compile # generate requirements.txt
before_script:
  - pip install -e .[dev] # install dev dependencies to test
script:
- python -m pytest # unit tests
- python setup.py build install # build and install so that I can test
- cd tests/assets
- python -m tree_stat sample-tree -o travis-stat.md # test script against sample data
- diff travis-stat.md sample-tree-stat.md # compare sample result with expected result
- cd ../..
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  user: ahorgnies
  server: https://test.pypi.org/legacy/
  on:
    tags: true
  password:
    secure: "dxnOsw6fzD39BhAFD5BzbOI8mYlnvSb5USQnxw9511M7DGB1kt6nCRFBpFC2IrZeZpJY/D1ZiMbgCDvc+FEydIU29UCBgppFTDCH2R5K79OYBwtxyfRMaRzco0VDZRVD4gFWEKbKX086V89xLr7SX3CQTMhq6EryTOCmQFJozwaJ2thJcFAJASoh6ERUApbXot/ZrlWGaTWYP+PaAT8G9ZDT1L/kxvi2vz7wCGyJqAfUzJJCP9pgNdAA4AQFPpsY9CMMGxD1l599x9okAAqnXg6EO2HOjRqgHT8M54ygyxoyv9RVqffb9MhNMut2a3jOIuaO8MT4Mr7LOgev8UvQgpRaRwvl8tHjIXl8HloyYPdKJ5CwcNYoM/PcM8zgfC9DPlPeXfgmdXtjAhV0zJ6nZN4p4XBAaz/O4v8kzELSjvZ9ff7fGffEVWSpAhCwHM+RRPq4hsAEFcuYwsUGc9KnFbznAAceQDd8G7ggwtbc1h8O7ewLxhKDm/Z9h5pnPTkaYGMqx9TwOVXkZEgsk8jO4ylNcyVBqVjfrjWEnXnMBKCY3uowlO/Rg6FsecbbpTYKQUQ44B0L170oAIb0Ugl2z4fdK2M298GhYW73++oHos8omft+xSEyer/XzPGC79GENUgCD6aQkcrKrJYR0wjb6o+Jw+kZsduOmHMEtVhqmYs="
