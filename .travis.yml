dist: xenial
language: python
python:
- '3.5'
- '3.6'
- '3.7'
cache: pip
before_install:
- pip install --upgrade pip # travis use an ancient version...
- pip install pip-tools # pip-tools to generate requirements.txt
- pip-compile # generate requirements.txt
before_script:
  - pip install -e .[dev] # install dev dependencies to test
script:
- python -m pytest # unit tests
- python setup.py build install # build and install so that I can test
- cd tests/assets
- python -m tree_stat sample-tree -o travis-stat.md # test script against sample data
- diff travis-stat.md sample-tree-stat.md # compare sample result with expected result
- cd ../..
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  user: ahorgnies
  server: https://test.pypi.org/legacy/
  on:
    tags: true
  password:
    secure: M4DDo7S4goqpA31W/uSAafK1HTB+/sKFa8PnmdbxdV+4lAQUP+oSSZDkACifoxO9ULdduYmLySPCQprdY9zSfG88hjzPc+3fVohdIfdmWbgarmrwb2cbMDi+Z+TsFZhojLnEwobV8IKj4oWAUp66R8Q9VMxHELza4Xmsy8Du/+zIMU9p/HZmhOnM8fHUcnD/2mJJq4jEguHydFVEHxqrVaP9ookJFnglBqPqbXvG+HKOVHiNHHSUfhVZccVV4qglu0hqormdEc2T25Fha+bbTcGvmnWGSFWP3tXuqNLtIGyndXlpQt/n0cj6PIbUee7hCA8O3DK9GBSQ3IKZ5+4kPl2sYGLHx9tZTXtMc8pi8qrEY8+gMCyoxPmZ6mUsf9CIuw8BH6W0v685D0NIpKOsZE/RQjO5urTfgcKTwx7z4tkI5r5+zlzqahRHREJM6r3SlYJi+xV3y5VxNQI8Umb06HIvjwCwYEOveOxiTgaRR+D7vKwhnQCrOJ7F73QnQPhfgXlxGyaSJG/Ye8U79SK/vrqXYYYHLpoRnnGy1mzCpiwjWdBe4rkgtre3e2vLUGmxLqso2d+Mwlc0PvrsJsjuzQth2+3K0WXCtnbgSElq4ub33NetKZI/04Mye4GkeXUG2E3uG6agxCbTRXyME//8Oql8QguFEMwHOxPm/b3rpiE=
